#!/usr/bin/python3

def main(input_file,expansion):
	with open(input_file) as f:
		input_lines = [[c for c in line.rstrip()] for line in f.readlines()]

	i1 = 0
	row_expand = set()
	while i1 < len(input_lines):
		if '#' not in input_lines[i1]:
			input_lines[i1] = ['e']*len(input_lines[i1])
		else:
			for i2,c in enumerate(input_lines[i1]):
				if c == '#':
					row_expand.add(i2)
		i1 += 1

	i1 = 0
	while i1 < len(input_lines):
		for i2 in range(len(input_lines[i1])-1,-1,-1):
			if i2 not in row_expand:
				input_lines[i1][i2] = 'e'
		i1 += 1
	
	fgal = 1
	coords = dict()
	offy = 0
	for line in input_lines:
		offx = 0
		if line == ['e'] * len(line):
			offy += expansion
			continue
		for char in line:
			if char == '#':
				coords[fgal] = (offy,offx)
				fgal += 1
			elif char == 'e':
				offx += expansion
				continue
			offx += 1
		offy += 1

	result = 0
	for gal_a,coord_a in coords.items():
		for gal_b,coord_b in coords.items():
			if gal_b > gal_a:
				result += abs(coord_a[0] - coord_b[0]) + abs(coord_a[1] - coord_b[1])
				
	return result

if __name__ == "__main__":
	test_value = main("TEST",100)
	assert test_value == 8410,"Test failed, expected 8410, result "+str(test_value)
	print(main("INPUT",1000000))
